<div class="patient-list-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-title">
        <i class="fas fa-users"></i>
        <h2>Pacientes</h2>
        <span class="badge badge-count" *ngIf="totalElements > 0">{{ formatNumber(totalElements) }}</span>
      </div>
      <button class="btn btn-primary btn-add" [routerLink]="['new']">
        <i class="fas fa-plus"></i>
        <span>Nuevo Paciente</span>
      </button>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="search-section">
    <form class="search-form">
      <div class="search-inputs">
        <div class="search-input-group">
          <i class="fas fa-user search-icon"></i>
          <input
            type="text"
            class="form-control search-input"
            placeholder="Buscar por nombre..."
            [formControl]="nombre"
            (keyup.enter)="searchPage(0)">
        </div>
        <div class="search-input-group">
          <i class="fas fa-user-tag search-icon"></i>
          <input
            type="text"
            class="form-control search-input"
            placeholder="Buscar por apellidos..."
            [formControl]="apellidos"
            (keyup.enter)="searchPage(0)">
        </div>
        <button type="button" class="btn btn-search" (click)="searchPage(0)">
          <i class="fas fa-search"></i>
          <span class="btn-text">Buscar</span>
        </button>
        <button
          type="button"
          class="btn btn-clear"
          (click)="clearSearch()"
          *ngIf="nombre.value || apellidos.value">
          <i class="fas fa-times"></i>
          <span class="btn-text">Limpiar</span>
        </button>
      </div>
    </form>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="pacientes.length === 0">
    <div class="empty-state-icon">
      <i class="fas fa-user-slash"></i>
    </div>
    <h3>No hay pacientes</h3>
    <p>Comienza agregando un nuevo paciente a la base de datos</p>
    <button class="btn btn-primary" [routerLink]="['new']">
      <i class="fas fa-plus"></i>
      Agregar Primer Paciente
    </button>
  </div>

  <!-- Patients Table -->
  <div class="table-container" *ngIf="pacientes.length > 0">
    <div class="table-responsive">
      <table class="patients-table">
        <thead>
          <tr>
            <th class="col-name">
              <div class="th-content">
                <i class="fas fa-user"></i>
                <span>Nombre</span>
              </div>
            </th>
            <th class="col-lastname">
              <div class="th-content">
                <i class="fas fa-user-tag"></i>
                <span>Apellidos</span>
              </div>
            </th>
            <th class="col-age">
              <div class="th-content">
                <i class="fas fa-birthday-cake"></i>
                <span>Edad</span>
              </div>
            </th>
            <th class="col-sex">
              <div class="th-content">
                <i class="fas fa-venus-mars"></i>
                <span>Sexo</span>
              </div>
            </th>
            <th class="col-email">
              <div class="th-content">
                <i class="fas fa-envelope"></i>
                <span>Email</span>
              </div>
            </th>
            <th class="col-phone">
              <div class="th-content">
                <i class="fas fa-phone"></i>
                <span>Teléfono</span>
              </div>
            </th>
            <th class="col-actions">
              <div class="th-content">
                <i class="fas fa-cog"></i>
                <span>Acciones</span>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let paciente of pacientes; let i = index" class="patient-row">
            <td class="col-name">
              <div class="patient-name">
                <div class="avatar">
                  {{ getInitials(paciente.name) }}
                </div>
                <span>{{ paciente.name }}</span>
              </div>
            </td>
            <td class="col-lastname">{{ paciente.lastName }}</td>
            <td class="col-age">
              <span class="age-badge">{{ edad(paciente.birthdate.toString()) }} años</span>
            </td>
            <td class="col-sex">
              <span class="badge badge-sex" [class.badge-male]="paciente.sex === 'M'" [class.badge-female]="paciente.sex === 'F'">
                <i class="fas" [class.fa-mars]="paciente.sex === 'M'" [class.fa-venus]="paciente.sex === 'F'"></i>
                {{ paciente.sex === 'M' ? 'Masculino' : 'Femenino' }}
              </span>
            </td>
            <td>{{ paciente.email }}</td>
            <td class="col-phone">
              <a [href]="'tel:' + paciente.phone" class="phone-link" title="Llamar a {{ paciente.name }}">
                
                <span class="phone-text">
                  <i class="fas fa-phone-alt"></i>
                  <span>{{ paciente.phone | phoneFormat }}</span>
                </span>
              </a>
                
            </td>
            <td class="col-actions">
              <button
                class="btn btn-view"
                [routerLink]="['/paciente/view/' + paciente.id]"
                title="Ver detalles del paciente">
                <i class="fas fa-eye"></i>
                <span>Ver</span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" *ngIf="totalElements > 0">
      <div class="pagination-info">
        <span class="info-text">
          Mostrando <strong>{{ formatNumber(rangeStart) }} - {{ formatNumber(rangeEnd) }}</strong> de <strong>{{ formatNumber(totalElements) }}</strong> pacientes
        </span>
      </div>

      <nav class="pagination-nav" *ngIf="!(nombre.value || apellidos.value)">
        <ul class="pagination">
          <li class="page-item" [class.disabled]="first">
            <button class="page-link" (click)="getPage(page - 1)" [disabled]="first">
              <i class="fas fa-chevron-left"></i>
              <span class="page-text">Anterior</span>
            </button>
          </li>

          <li class="page-item" *ngIf="page > 0">
            <button class="page-link" (click)="getPage(page - 1)">{{ page }}</button>
          </li>

          <li class="page-item active">
            <button class="page-link">{{ page + 1 }}</button>
          </li>

          <li class="page-item" *ngIf="!last">
            <button class="page-link" (click)="getPage(page + 1)">{{ page + 2 }}</button>
          </li>

          <li class="page-item" [class.disabled]="last">
            <button class="page-link" (click)="getPage(page + 1)" [disabled]="last">
              <span class="page-text">Siguiente</span>
              <i class="fas fa-chevron-right"></i>
            </button>
          </li>
        </ul>
      </nav>

      <nav class="pagination-nav" *ngIf="nombre.value || apellidos.value">
        <ul class="pagination">
          <li class="page-item" [class.disabled]="first">
            <button class="page-link" (click)="searchPage(page - 1)" [disabled]="first">
              <i class="fas fa-chevron-left"></i>
              <span class="page-text">Anterior</span>
            </button>
          </li>

          <li class="page-item" *ngIf="page > 0">
            <button class="page-link" (click)="searchPage(page - 1)">{{ page }}</button>
          </li>

          <li class="page-item active">
            <button class="page-link">{{ page + 1 }}</button>
          </li>

          <li class="page-item" *ngIf="!last">
            <button class="page-link" (click)="searchPage(page + 1)">{{ page + 2 }}</button>
          </li>

          <li class="page-item" [class.disabled]="last">
            <button class="page-link" (click)="searchPage(page + 1)" [disabled]="last">
              <span class="page-text">Siguiente</span>
              <i class="fas fa-chevron-right"></i>
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
